%encoding "utf-8"
%version 1.0

#(
Author:  Onotoa

This schema was created with onotoa
http://onotoa.topicmapslab.de

Generated by tinyTiM -- http://tinytim.sourceforge.net/

)#

#########################################################################
# TMCL - Topic Maps Constraint Language
# This file defines the set of templates defined in the TMCL standard
# This document is located at http://www.isotopicmaps.org/tmcl/templates.ctm 
# and is normative.
# Draft version of 2009-10-19.
#########################################################################

# prefix declarations
%prefix tmcl http://psi.topicmaps.org/tmcl/
%prefix tmdm http://psi.topicmaps.org/iso13250/model/


# Overlap Declaration
def overlaps($tt1, $tt2)
  ?c isa tmcl:overlap-declaration.
  tmcl:overlaps(tmcl:allows : ?c, tmcl:allowed : $tt1)
  tmcl:overlaps(tmcl:allows : ?c, tmcl:allowed : $tt2)
end

# Abstract Topic Type Constraint
def is-abstract($tt)
  ?c isa tmcl:abstract-constraint.
  tmcl:constrained-topic-type(tmcl:constrains : ?c, tmcl:constrained : $tt)
end

# Subject Identifier Constraint
def has-subject-identifier($tt, $min, $max, $regexp)
  ?c isa tmcl:subject-identifier-constraint;
    tmcl:card-min: $min;
    tmcl:card-max: $max;
    tmcl:regexp: $regexp.
  tmcl:constrained-topic-type(tmcl:constrains : ?c, tmcl:constrained : $tt)
end

# Subject Locator Constraint
def has-subject-locator($tt, $min, $max, $regexp)
  ?c isa tmcl:subject-locator-constraint;
    tmcl:card-min: $min;
    tmcl:card-max: $max;
    tmcl:regexp: $regexp.
  tmcl:constrained-topic-type(tmcl:constrains : ?c, tmcl:constrained : $tt)
end

# Topic Name Constraint
def has-name($tt, $nt, $min, $max)
  ?c isa tmcl:topic-name-constraint;
    tmcl:card-min: $min;
    tmcl:card-max: $max.
  
  tmcl:constrained-topic-type(tmcl:constrains : ?c, tmcl:constrained : $tt)  
  tmcl:constrained-statement(tmcl:constrains : ?c, tmcl:constrained : $nt)
end

# Topic Occurrence Constraint
def has-occurrence($tt, $ot, $min, $max)
  ?c isa tmcl:topic-occurrence-constraint;
    tmcl:card-min: $min;
    tmcl:card-max: $max.
  
  tmcl:constrained-topic-type(tmcl:constrains : ?c, tmcl:constrained : $tt)  
  tmcl:constrained-statement(tmcl:constrains : ?c, tmcl:constrained : $ot)
end

# Topic Role Constraint
def plays-role($tt, $rt, $at, $min, $max)
  ?c isa tmcl:topic-role-constraint;
    tmcl:card-min: $min;
    tmcl:card-max: $max.
  
  tmcl:constrained-topic-type(tmcl:constrains : ?c, tmcl:constrained : $tt)  
  tmcl:constrained-statement(tmcl:constrains : ?c, tmcl:constrained : $rt)
  tmcl:constrained-role(tmcl:constrains : ?c, tmcl:constrained : $at)
end

# Scope Constraint
def has-scope($st, $tt, $min, $max)
  c isa tmcl:scope-constraint;
    tmcl:card-min: $min;
    tmcl:card-max: $max.
  
  tmcl:constrained-statement(tmcl:constrains : c, tmcl:constrained : $st)
  tmcl:allowed-scope(tmcl:allows : c, tmcl:allowed : $tt)
end

# Reifier Constraint
def must-have-reifier($st, $tt)
  ?c isa tmcl:reifier-constraint;
    tmcl:card-min: 1;
    tmcl:card-max: 1.
  tmcl:constrained-statement(tmcl:constrains: ?c, tmcl:constrained: $st)
  tmcl:allowed-reifier(tmcl:allows: ?c, tmcl:allowed: $tt)
end

def cannot-have-reifier($st)
  ?c isa tmcl:reifier-constraint;
    tmcl:card-min: 0;
    tmcl:card-max: 0.
  tmcl:constrained-statement(tmcl:constrains: ?c, tmcl:constrained: $st)
  tmcl:allowed-reifier(tmcl:allows: ?c, tmcl:allowed: tmdm:subject)
end

def may-have-reifier($st, $tt)
  ?c isa tmcl:reifier-constraint;
    tmcl:card-min: 0;
    tmcl:card-max: 1.
  tmcl:constrained-statement(tmcl:constrains: ?c, tmcl:constrained: $st)
  tmcl:allowed-reifier(tmcl:allows: ?c, tmcl:allowed: $tt)
end

# Topic Reifies Constraint
def must-reify($tt, $st)
  ?c isa tmcl:topic-reifies-constraint;
    tmcl:card-min: 1;
    tmcl:card-max: 1.
  tmcl:constrained-topic-type(tmcl:constrains: ?c, tmcl:constrained: $tt)
  tmcl:constrained-statement(tmcl:constrains: ?c, tmcl:constrained: $st)
end

def cannot-reify($tt)
  ?c isa tmcl:topic-reifies-constraint;
    tmcl:card-min: 0;
    tmcl:card-max: 0.
  tmcl:constrained-topic-type(tmcl:constrains: ?c, tmcl:constrained: $tt)
end

def may-reify($tt, $st)
  ?c isa tmcl:topic-reifies-constraint;
    tmcl:card-min: 0;
    tmcl:card-max: 1.
  tmcl:constrained-topic-type(tmcl:constrains: ?c, tmcl:constrained: $tt)
  tmcl:constrained-statement(tmcl:constrains: ?c, tmcl:constrained: $st)
end

# Association Role Constraint
def has-role($at, $rt, $min, $max)
  ?c isa tmcl:association-role-constraint;
    tmcl:card-min: $min;
    tmcl:card-max: $max.
  
  tmcl:constrained-statement(tmcl:constrains : ?c, tmcl:constrained : $at)
  tmcl:constrained-role(tmcl:constrains : ?c, tmcl:constrained : $rt)
end

# Role Combination Constraint
def role-combination($at, $rt, $tt, $ort, $ott)
  ?c isa tmcl:role-combination-constraint.
  tmcl:constrained-statement(tmcl:constrains: ?c, tmcl:constrained: $at)
  tmcl:constrained-role(tmcl:constrains: ?c, tmcl:constrained: $rt)
  tmcl:constrained-topic-type(tmcl:constrains: ?c, tmcl:constrained: $tt)
  tmcl:other-constrained-role(tmcl:constrains: ?c, tmcl:constrained: $ort)
  tmcl:other-constrained-topic-type(tmcl:constrains: ?c, tmcl:constrained: $ott)
end

# Occurrence Data Type Constraint
def has-datatype($ot, $dt)
  ?c isa tmcl:occurrence-datatype-constraint;
    tmcl:datatype: $dt.
  tmcl:constrained-statement(tmcl:constrains : ?c, tmcl:constrained : $ot)
end

# Unique Value Constraint
def is-unique($st)
  ?c isa tmcl:unique-value-constraint.
  tmcl:constrained-statement(tmcl:constrains : ?c, tmcl:constrained : $st)
end

# Regular Expression Constraint
def matches-regexp($st, $regexp)
  ?c isa tmcl:regular-expression-constraint;
    tmcl:regexp: $regexp.
  
  tmcl:constrained-statement(tmcl:constrains: ?c, tmcl:constrained: $st)
end

# Additional TMCL Templates
def binary-association($at, $rt1, $rt2)
  $at isa tmcl:association-type;
    has-role($rt1, 1, 1);
    has-role($rt2, 1, 1).

  $rt1 isa tmcl:role-type.
  $rt2 isa tmcl:role-type.
end

# Additional TMCL Templates
def symmetric-association($at, $rt)
  $at isa tmcl:association-type;
    has-role($rt, 2, 2).

  $rt isa tmcl:role-type.
end

# The Schema Topic
def belongs-to($construct, $schema)
  tmcl:belongs-to-schema(tmcl:container: $schema, tmcl:containee: $construct)
end


#-- ONTOLOGY


#-- Topic Types


#-- TT: <http://psi.topicmaps.org/tmcl/topic-type>

default01 isa tmcl:topic-type;
    - "default0".



#-- INSTANCES


#-- Topics


#-- TT: <http://psi.topicmaps.org/tmcl/association-type>

lifes-in37 isa tmcl:association-type;
    - "lifes-in";
    has-role(role_adress40, 1, 1);
    has-role(role_person39, 1, 1);
    role-combination(role_adress40, adress22, role_person39, person0);
    must-have-reifier(tmdm:subject).

located-in26 isa tmcl:association-type;
    - "located-in";
    has-role(containee36, 1, 1);
    has-role(container35, 1, 1);
    role-combination(container35, country11, containee36, city18).

part-off21 isa tmcl:association-type;
    - "part-off";
    role-combination(container35, city18, containee36, adress22).


#-- TT: <http://psi.topicmaps.org/tmcl/name-type>

english-name14 isa tmcl:name-type;
    - "english-name";
    has-scope(i18n10, 1, 1);
    cannot-have-reifier().

firstname3 isa tmcl:name-type;
    - "firstname";
    may-have-reifier(person0).

lastname6 isa tmcl:name-type;
    - "lastname".

name12 isa tmcl:name-type;
    - "name";
    must-have-reifier(tmdm:subject).


#-- TT: <http://psi.topicmaps.org/tmcl/occurrence-type>

age9 isa tmcl:occurrence-type;
    - "age";
    has-datatype("xsd:integer").

email7 isa tmcl:occurrence-type;
    - "email";
    has-datatype("xsd:anyURI");
    matches-regexp(".*@.*").

street23 isa tmcl:occurrence-type;
    - "street";
    has-datatype("xsd:string").

zipcode24 isa tmcl:occurrence-type;
    - "zipcode";
    has-datatype("xsd:string").


#-- TT: <http://psi.topicmaps.org/tmcl/role-type>

containee36 isa tmcl:role-type;
    - "containee".

container35 isa tmcl:role-type;
    - "container".

role_adress40 isa tmcl:role-type;
    - "role_adress".

role_person39 isa tmcl:role-type;
    - "role_person".


#-- TT: <http://psi.topicmaps.org/tmcl/topic-type>

adress22 isa tmcl:topic-type;
    - "adress";
    plays-role(containee36, part-off21, 0, "*"^^<ctm:integer>);
    plays-role(role_adress40, lifes-in37, 0, "*"^^<ctm:integer>);
    has-occurrence(zipcode24, 1, 1);
    has-occurrence(street23, 1, 1).

city18 isa tmcl:topic-type;
    - "city";
    has-subject-identifier(1, 1, "city/[0-9]*");
    plays-role(container35, part-off21, 0, "*"^^<ctm:integer>);
    plays-role(containee36, located-in26, 0, "*"^^<ctm:integer>);
    has-name(name12, 1, 1);
    may-reify(part-off21).

country11 isa tmcl:topic-type;
    - "country";
    plays-role(container35, located-in26, 0, "*"^^<ctm:integer>);
    has-name(english-name14, 1, 1);
    has-name(name12, 1, 1).

default12 isa tmcl:topic-type;
    - "default1".

i18n10 isa tmcl:topic-type;
    - "i18n";
    is-abstract();
    has-subject-identifier(1, 1, "http://de.wikipedia.org/i18n").


#-- TT: default01

person0 isa default01;
    isa tmcl:topic-type;
    ako default12;
    - "person";
    has-subject-identifier(1, 1, "http://de.wikipedia.org/person/[0-9]*");
    has-subject-identifier(1, 1, "person/[0-9]*");
    plays-role(role_person39, lifes-in37, 0, "*"^^<ctm:integer>);
    has-occurrence(email7, 1, 1);
    has-occurrence(age9, 1, 1);
    has-name(firstname3, 1, 1);
    has-name(lastname6, 1, 1).

# Thanks for using tinyTiM -- http://tinytim.sourceforge.net/ :)
